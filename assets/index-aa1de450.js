import{W as u}from"./blocks-7b093098.js";import{r as k,e as E}from"./iframe-22864007.js";const{STORY_CHANGED:O,SELECT_STORY:L}=__STORYBOOK_MODULE_CORE_EVENTS__,{global:T}=__STORYBOOK_MODULE_GLOBAL__,{makeDecorator:y,addons:p}=__STORYBOOK_MODULE_PREVIEW_API__;var C="links",{document:c,HTMLElement:R}=T;function v(t){let e={},i=(t[0]==="?"?t.substring(1):t).split("&").filter(Boolean);for(let n=0;n<i.length;n++){let r=i[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return e}var h=t=>p.getChannel().emit(L,t),D=(t,e)=>new Promise(i=>{let{location:n}=c,r=v(n.search).id,s=t||r.split("--",2)[0],o=`/story/${u(s,e)}`,l=n.pathname.replace(/iframe\.html$/,""),f=`${n.origin+l}?${Object.entries({path:o}).map(d=>`${d[0]}=${d[1]}`).join("&")}`;i(f)}),m=t=>{let{target:e}=t;if(!(e instanceof R))return;let i=e,{sbKind:n,sbStory:r}=i.dataset;(n||r)&&(t.preventDefault(),h({kind:n,story:r}))},a=!1,K=()=>{a||(a=!0,c.addEventListener("click",m))},g=()=>{a&&(a=!1,c.removeEventListener("click",m))};y({name:"withLinks",parameterName:C,wrapper:(t,e)=>(K(),p.getChannel().once(O,g),t(e))});var b=0,S=t=>t.button===b&&!t.altKey&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey,U=(t,e=i=>{})=>{S(t)&&(t.preventDefault(),e(t))},_=class extends k.PureComponent{constructor(){super(...arguments),this.state={href:"/"},this.updateHref=async()=>{let{kind:t,title:e=t,story:i,name:n=i}=this.props;if(e&&n){let r=await D(e,n);this.setState({href:r})}},this.handleClick=()=>{let{kind:t,title:e=t,story:i,name:n=i}=this.props;e&&n&&h({title:e,name:n})}}componentDidMount(){this.updateHref()}componentDidUpdate(t){let{kind:e,title:i,story:n,name:r}=this.props;(t.kind!==e||t.story!==n||t.title!==i||t.name!==r)&&this.updateHref()}render(){let{kind:t,title:e=t,story:i,name:n=i,children:r,...s}=this.props,{href:o}=this.state;return E.createElement("a",{href:o,onClick:l=>U(l,this.handleClick),...s},r)}};_.defaultProps={children:void 0};var Y=_;export{Y as r};
